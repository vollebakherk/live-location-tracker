<!DOCTYPE html>
<html>
<head>
    <title>Vossenjacht - Live Overzicht</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: Arial, sans-serif; 
            height: 100vh;
            display: flex;
            flex-direction: column;
            background: #2c3e50;
            color: white;
        }
        .header {
            padding: 20px;
            background: #27ae60;
            text-align: center;
        }
        .info {
            padding: 15px;
            background: #34495e;
            font-size: 14px;
        }
        .links {
            padding: 15px;
            background: #2980b9;
            text-align: center;
        }
        .links a {
            color: white;
            text-decoration: none;
            margin: 0 15px;
            padding: 10px 20px;
            background: rgba(255,255,255,0.2);
            border-radius: 5px;
            display: inline-block;
        }
        .links a:hover {
            background: rgba(255,255,255,0.3);
        }
        #map { flex-grow: 1; width: 100%; }
        .vos-badge { background: #e74c3c; }
        .zoeker-badge { background: #3498db; }
    </style>
</head>
<body>
    <div class="header">
        <h1>üåç Vossenjacht - Live Overzicht</h1>
        <p>Volg alle spelers in real-time</p>
    </div>
    
    <div class="links">
        <a href="/tracker" target="_blank">ü¶ä Word de Vos</a>
        <a href="/zoeker" target="_blank">üë§ Word Zoeker</a>
    </div>
    
    <div class="info" id="status">
        Verbinden... <span id="vosStatus">Geen vos actief</span>
    </div>
    
    <div id="map"></div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        let map;
        const markers = {};
        
        // Icons
        const icons = {
            vos: L.divIcon({
                className: 'vos-icon',
                html: `<div style="background: #e74c3c; width: 25px; height: 25px; border-radius: 50%; border: 3px solid white; display: flex; align-items: center; justify-content: center; font-weight: bold; color: white; font-size: 12px;">ü¶ä</div>`,
                iconSize: [31, 31],
                iconAnchor: [15, 15]
            }),
            zoeker: L.divIcon({
                className: 'zoeker-icon',
                html: `<div style="background: #3498db; width: 22px; height: 22px; border-radius: 50%; border: 3px solid white; display: flex; align-items: center; justify-content: center; font-weight: bold; color: white; font-size: 10px;">üë§</div>`,
                iconSize: [28, 28],
                iconAnchor: [14, 14]
            })
        };

        // Kaart
        map = L.map('map').setView([50.9010206, 5.3104384], 13);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '¬© OpenStreetMap contributors',
            maxZoom: 19
        }).addTo(map);

        // Socket events
        socket.on('vosStatus', (data) => {
            document.getElementById('vosStatus').innerHTML = data.hasVos 
                ? `<span style="color: #e74c3c;">ü¶ä Vos: ${data.vosName}</span>`
                : '<span style="color: #95a5a6;">Geen vos actief</span>';
        });

        socket.on('locationUpdate', (location) => {
            const markerId = location.trackerId;
            
            if (markers[markerId]) {
                map.removeLayer(markers[markerId]);
            }

            const iconType = location.isVos ? icons.vos : icons.zoeker;
            const popupText = location.isVos 
                ? `<b>ü¶ä DE VOS!</b><br>${location.name}` 
                : `<b>üë§ ${location.name}</b>`;

            markers[markerId] = L.marker([location.lat, location.lng], { icon: iconType })
                .addTo(map)
                .bindPopup(popupText);

            if (location.isVos) {
                map.setView([location.lat, location.lng], 16);
            }
        });
    </script>
</body>
</html>
